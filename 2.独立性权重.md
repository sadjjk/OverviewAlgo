## 综合评价法-独立性权重

#### 理论概述

利用指标之间的共线性强弱来确定权重。

如果说某指标与其它指标的相关性很强，说明信息有着较大的重叠，意味着该指标的权重会比较低。

反之如果说某指标与其它指标的相关性较弱，那么说明该指标携带的信息量较大，该指标应该赋予更高的权重。

共线性强弱由回归分析得到的**复相关系数*R* 值**来表示

**复相关系数反映了一个变量与另一组变量的密切程度。**

比如有5个指标，那么指标1作为因变量，其余4个指标作为自变量进行回归分析，就会得到复相关系数*R* 值

余下4个指标重复进行即可

R值越大说明共线性越强，权重越低

复相关系数*R* 值的倒数即1/*R* ，进行归一化后即得到各指标的权重。

#### 数据说明

设共有 ![[公式]](https://www.zhihu.com/equation?tex=n) 个待评价对象，每个对象都有 ![[公式]](https://www.zhihu.com/equation?tex=m+) 个指标(属性)，即如下所示：

<img src="https://i.loli.net/2021/03/05/AqKzwRxh73UWTui.png" alt="[公式]" style="zoom:50%;" />

举例数据

| 编号    | 专业课1 | 专业课2 | 专业课3 | 专业课4 |
| ------- | ------- | ------- | ------- | ------- |
| 应聘者1 | 67      | 90      | 67      | 81      |
| 应聘者2 | 82      | 73      | 95      | 85      |
| 应聘者3 | 67      | 92      | 79      | 78      |
| 应聘者4 | 82      | 81      | 86      | 76      |
| 应聘者5 | 70      | 91      | 82      | 89      |
| 应聘者6 | 72      | 90      | 89      | 74      |
| 应聘者7 | 82      | 85      | 92      | 69      |
| 应聘者8 | 85      | 72      | 72      | 92      |
| 应聘者9 | 82      | 69      | 71      | 86      |

#### 计算步骤

##### 0.数据量纲化和同向化

若数据已量纲化和同向化 则可忽略此步骤

由于举例数据的各项指标均处于0~100分 

大小一致 故该步骤省略跳过

#####  1.计算复相关系数

每个指标依次作为因变量，其余4个指标作为自变量 计算各指标的复相关系数

如何计算当前指标的复相关系数？

假设当前指标为第一个指标:专业课1

第一步 用指标1:专业课1(Y) 作多元回归模型

![img](https://i.loli.net/2021/03/08/JKPfWDQdmSq7iU6.png)

第二步  曲线拟合 计算预测值 

第三步  计算复相关系数

​              计算公式为：

![img](https://bkimg.cdn.bcebos.com/formula/d3c7749613346f3fa4a5ea57097977f0.svg)

<img src="/Users/wangjy/Library/Application Support/typora-user-images/image-20210308164403232.png" alt="img" style="zoom:50%;" />

 举例数据中各个指标的复相关系数 计算得到如下:

| 指标       | 专业课1 | 专业课2 | 专业课3 | 专业课4 |
| ---------- | ------- | ------- | ------- | ------- |
| 复相关系数 | 0.9266  | 0.9359  | 0.642   | 0.7195  |

##### 2.计算权重系数

| 指标           | 专业课1 | 专业课2 | 专业课3 | 专业课4 |
| -------------- | ------- | ------- | ------- | ------- |
| 复相关系数 R值 | 0.9266  | 0.9359  | 0.642   | 0.7195  |
| 1/R            | 1.0792  | 1.0685  | 1.5576  | 1.3899  |
| 权重 h         | 21.18%  | 20.97%  | 30.57%  | 27.28%  |

##### 3.计算对象得分

<img src="https://i.loli.net/2021/03/05/xOBoFG1fe9ZHEu6.png" style="zoom:50%;" />

| 编号    | 专业课1 | 专业课2 | 专业课3 | 专业课4 | 总分  |
| ------- | ------- | ------- | ------- | ------- | ----- |
| 应聘者1 | 67      | 90      | 67      | 81      | 75.64 |
| 应聘者2 | 82      | 73      | 95      | 85      | 84.91 |
| 应聘者3 | 67      | 92      | 79      | 78      | 78.91 |
| 应聘者4 | 82      | 81      | 86      | 76      | 81.38 |

#### 代码实践

```python
# 代码段
import numpy as np
import statsmodels.api as sm
def get_independent_weight(data):
    data = np.array(data)
    R_list = []
    for index in range(data.shape[1]):
        # 计算R值
        X = sm.add_constant(np.delete(data, index, 1))
        y = data[:, index]
        model = sm.OLS(y, X).fit()
        R = round(math.sqrt(model.rsquared), 4)
        R_list.append(R)

    R_1_sum = sum([round(1 / r, 4) for r in R_list])
    return [1 / r / R_1_sum for r in R_list]
```



 

