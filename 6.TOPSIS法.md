# 综合评价法-TOPSIS法

#### 理论概述

基于优劣解距离来综合衡量指标的客观权重

采用余弦法找出有限方案中的最优方案和最劣方案

然后分别计算各评价对象与最优方案和最劣方案间的距离

获得各评价对象与最优方案的相对接近程度，以此作为评价优劣的依据

#### 数据说明

设共有 ![[公式]](https://www.zhihu.com/equation?tex=n) 个待评价对象，每个对象都有 ![[公式]](https://www.zhihu.com/equation?tex=m+) 个指标(属性)，即如下所示：

<img src="https://i.loli.net/2021/03/05/AqKzwRxh73UWTui.png" alt="[公式]" style="zoom:50%;" />

举例数据

| 编号    | 专业课1 | 专业课2 | 专业课3 | 专业课4 |
| ------- | ------- | ------- | ------- | ------- |
| 应聘者1 | 67      | 90      | 67      | 81      |
| 应聘者2 | 82      | 73      | 95      | 85      |
| 应聘者3 | 67      | 92      | 79      | 78      |
| 应聘者4 | 82      | 81      | 86      | 76      |
| 应聘者5 | 70      | 91      | 82      | 89      |
| 应聘者6 | 72      | 90      | 89      | 74      |
| 应聘者7 | 82      | 85      | 92      | 69      |
| 应聘者8 | 85      | 72      | 72      | 92      |
| 应聘者9 | 82      | 69      | 71      | 86      |

#### 计算步骤

##### 1.数据预处理

若数据已量纲化和同向化 则可忽略此步骤

由于举例数据的各项指标均处于0~100分 均为正向

使用正则化 2-范数 进行去量纲化

![img](https://i.loli.net/2021/03/09/o2zXIcrGiqC1ATa.png)

处理后得到标准化矩阵 ![[公式]](https://www.zhihu.com/equation?tex=Z) <img src="https://i.loli.net/2021/03/09/GK7lkuYfFIogsCn.png" alt="img" style="zoom:50%;" />

举例数据 标准化后

| 编号    | 专业课1 | 专业课2 | 专业课3 | 专业课4 |
| ------- | ------- | ------- | ------- | ------- |
| 应聘者1 |0.0972 |0.1211 |0.0914 |0.111 |
| 应聘者2 |0.119  |0.0983 |0.1296 |0.1164|
| 应聘者3 |0.0972 |0.1238 |0.1078 |0.1068|
| 应聘者4 |0.119  |0.109  |0.1173 |0.1041|
| 应聘者5 |0.1016 |0.1225 |0.1119 |0.1219|
| 应聘者6 |0.1045 |0.1211 |0.1214 |0.1014|
| 应聘者7 |0.119  |0.1144 |0.1255 |0.0945|
| 应聘者8 |0.1234 |0.0969 |0.0982 |0.126 |
| 应聘者9 |0.119  |0.0929 |0.0969 |0.1178|

##### 2.确定最优方案和最劣方案

最优方案 ![[公式]](https://www.zhihu.com/equation?tex=Z%5E%2B) 由 ![[公式]](https://www.zhihu.com/equation?tex=Z) 中每列元素的最大值构成:

![img](https://i.loli.net/2021/03/09/I1ZnxR8PKcTospM.png)

举例数据![[公式]](https://www.zhihu.com/equation?tex=Z%5E%2B)

| 指标 | 专业课1 | 专业课2 | 专业课3 | 专业课4 |
| ---- | ------- | ------- | ------- | ------- |
| max  | 0.1234| 0.1238| 0.1296| 0.126|

最劣方案 ![[公式]](https://www.zhihu.com/equation?tex=Z%5E-) 由 ![[公式]](https://www.zhihu.com/equation?tex=Z) 中每列元素的最小值构成:

![img](https://i.loli.net/2021/03/09/aX1rmKZkUAnIoEQ.png)

举例数据 ![[公式]](https://www.zhihu.com/equation?tex=Z%5E-)

| 指标 | 专业课1 | 专业课2 | 专业课3 | 专业课4 |
| ---- | ------- | ------- | ------- | ------- |
| min  | 0.0972| 0.0929| 0.0914 |0.0945|

##### 3.计算各评价对象与最优方案、最劣方案的接近程度

<img src="https://i.loli.net/2021/03/09/FYxywE4oMNVidCn.png" alt="img" style="zoom:50%;" />

##### 4.计算各评价对象与最优方案的贴近程度 ![[公式]](https://www.zhihu.com/equation?tex=C_i)

<img src="https://i.loli.net/2021/03/09/rG5KYnTj7vqBZtm.png" alt="image-20210309193117205" style="zoom:50%;" />

![[公式]](https://www.zhihu.com/equation?tex=0%5Cle+C_i%5Cle+1%2C%5C%3B+C_i%5Cto1) 表明评价对象越优。

##### 5.对象打分

举例数据

| 对象 |得分 |
| ---- | ------- |
|应聘者1 | 0.3103|
|应聘者2 | 0.7615|
|应聘者3 | 0.4744|
|应聘者4 | 0.6329|
|应聘者5 | 0.719 |
|应聘者6 | 0.6341|
|应聘者7 | 0.6529|
|应聘者8 | 0.5042|
|应聘者9 | 0.3307|

#### 代码实践

```python
# 代码段
def get_topsis_score(data):
    data = np.array(data)
    data_scale = data / data.sum(axis=0)
    Z_add = np.max(data_scale, axis=0)
    Z_sub = np.min(data_scale, axis=0)
    D_add = np.square(Z_add - data_scale).sum(axis=1)
    D_sub = np.square(Z_sub - data_scale).sum(axis=1)
    return list(D_sub / (D_add+D_sub))
```

#### 熵权TOPSIS

即熵权法+TOPSIS法

在TOPSIS法的第3步中引入各指标合适的权重

<img src="https://i.loli.net/2021/03/10/ua2B5c8PhYEW3fZ.png" alt="img" style="zoom:50%;" />

各指标权重由熵权法计算得出 

当然也可以由其他方法得出权重

