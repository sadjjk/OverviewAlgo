# 综合评价法-CRITIC权重法

#### 理论概述

基于评价指标的**变异性**和**冲突性**来综合衡量指标的客观权重

- **指标变异性**：以标准差来表现，**标准差越大**，说明**波动越大，权重越高**；
- **指标冲突性**：用相关系数进行表示，若两个指标之间具有**较强的正相关**，说明其**冲突性小**，**权重越低**。

#### 数据说明

| 目标对象/维度 | 指标1 | 指标2 | 指标3 |
| :-----------: | :---: | :---: | :---: |
|     对象1     | 0.92  |  5.5  |   1   |
|     对象2     | 0.85  |   6   | 2.53  |
|     对象3     | 0.87  |  7.6  |  4.6  |
|     对象4     |  0.9  |  8.2  | 5.42  |
|     对象5     |  0.7  |  7.1  |  2.2  |

#### 计算步骤

##### 0.数据预处理

若数据已量纲化和同向化 则可忽略此步骤

该方法下使用归一化 不建议使用标准化

*PS:若使用标准化 则导致所有指标标准差一致 则指标的变异性无意义*

假设指标1、2为正向指标 、指标3为负向指标

量纲化和同向化后 得到

| 目标对象/量纲化&同向化 | 指标1 | 指标2 | 指标3 |
| :--------------------: | :---: | :---: | :---: |
|         对象1          | 1.00  | 0.00  | 1.00  |
|         对象2          | 0.68  | 0.19  | 0.65  |
|         对象3          | 0.77  | 0.78  | 0.19  |
|         对象3          | 0.91  | 1.00  | 0.00  |
|         对象5          | 0.00  | 0.59  | 0.73  |

#####  1.计算指标变异性

$$
\begin{array}{c}
\bar{x} = \frac{1}{n} \sum_{i = 1}^{n}  x_{ij} \\
S_{j} = \sqrt{\frac{\sum_{i=1}^{n}(x_{ij}-\bar{x})^{2}  }{n-1} }  
\end{array}
$$

即样本标准差 表示各指标的内取值的差异波动情况

标准差越大越能放映出更多的信息

该指标本身的评价强度也就越强

该指标分配的权重就越多

|    指标    | 指标1 | 指标2 | 指标3 |
| :--------: | :---: | :---: | :---: |
| 样本标准差 |0.3954| 0.4129| 0.4094|

##### 2.计算指标冲突性

$$
\begin{array}{c}
R_{j} = \sum_{i=1}^{n}(1-r_{ij} ) \\
r_{ij}:评价指标 i 和 j 之间的相关系数
\end{array}
$$

使用该指标与其他指标的相关系数之和表示冲突性

该指标就与其他指标的冲突性越小 则反映出相同的信息越多

所能体现的评价内容就越有重复之处

该指标分配的权重就越少

| 相关系数 | 指标1 | 指标2 | 指标3 |
| :------: | :---: | :---: | :---: |
|  指标1   | 1.00  | -0.13 | -0.21 |
|  指标2   | -0.13 | 1.00  | -0.91 |
|  指标3   | -0.21 | -0.91 | 1.00  |
|    R     | 2.34  | 3.03  | 3.12  |

##### 3.计算权重

$$
\begin{array}{c}
C_{j}=S_{j} \times  R_{j} \\
W_{j}=\frac{C_{j}}{ {\textstyle \sum_{i=1}^{n}}C_{j} } \\
W_{j}：第j个指标的权重
\end{array}
$$

|  指标  | 指标1  | 指标2  | 指标3  |
| :----: | :----: | :----: | :----: |
|   C    |  0.93  |  1.25  |  1.28  |
| W-权重 | 26.74% | 36.25% | 37.00% |

##### 5.对象打分

| 目标对象/<br />量纲化&同向化 | 指标1 | 指标2 | 指标3 |               计算方式                |  得分  |
| :--------------------------: | :---: | :---: | :---: | :-----------------------------------: | :----: |
|            对象1             |   1   |   0   |   1   |     1 * 0.2674+0 * 0.3625+1*0.37      | 0.6374 |
|            对象2             | 0.68  | 0.19  | 0.65  | 0.68 * 0.2674+0.19 * 0.3625+0.65*0.37 | 0.4912 |
|            对象3             | 0.77  | 0.78  | 0.19  | 0.77 * 0.2674+0.78 * 0.3625+0.19*0.37 | 0.5589 |
|            对象3             | 0.91  |   1   |   0   |    0.91 * 0.2674+1 * 0.3625+0*0.37    | 0.6058 |
|            对象5             |   0   | 0.59  | 0.73  |  0 * 0.2674+0.59 * 0.3625+0.73*0.37   | 0.4840 |

#### 代码实践

```python
# 代码段
def get_critic_weight(data):
    data = np.array(data)
    std = data.std(axis=0, ddof=1)
    R = (1 - np.corrcoef(data.T)).sum(axis=0)
    C = std * R
    return list(C / C.sum())
```

