## 综合评价法-熵权法

#### 理论概述

根据**各指标所含信息有序程度的差异性**来确定指标权重的客观赋权方法

熵用于度量不确定性 

若指标的离散程度越大（越无序） 则熵值越大

那么指标可提供的信息量越多  则该指标的权重也越大

#### 数据说明

设共有$n$ 个待评价对象，每个对象都有$m$个指标(属性)，即如下所示：
$$
\begin{pmatrix}  
  x_{11} & x_{12} & \cdots & x_{1m} \\  
  x_{21} & x_{22} & \cdots & x_{2m} \\  
  \vdots & \vdots & \ddots & \vdots \\  
  x_{n1} & x_{n2} & \cdots & x_{nm}  
\end{pmatrix}
$$
举例数据

| 编号    | 专业课1 | 专业课2 | 专业课3 | 专业课4 |
| ------- | ------- | ------- | ------- | ------- |
| 应聘者1 | 67      | 90      | 67      | 81      |
| 应聘者2 | 82      | 73      | 95      | 85      |
| 应聘者3 | 67      | 92      | 79      | 78      |
| 应聘者4 | 82      | 81      | 86      | 76      |
| 应聘者5 | 70      | 91      | 82      | 89      |
| 应聘者6 | 72      | 90      | 89      | 74      |
| 应聘者7 | 82      | 85      | 92      | 69      |
| 应聘者8 | 85      | 72      | 72      | 92      |
| 应聘者9 | 82      | 69      | 71      | 86      |

#### 计算步骤

##### 1.数据去量纲

量纲化的方法不唯一 

这里使用 **正则化 1-范数** 即
$$
p_{ij} = \frac{x_{xj}}{\sum_{i=1}^{n}x_{ij} }
$$
举例数据-量纲化

| 编号    | 专业课1-去量纲 | 专业课2-去量纲 | 专业课3-去量纲 | 专业课4-去量纲 |
| ------- | -------------- | -------------- | -------------- | -------------- |
| 应聘者1 | 0.097          | 0.121          | 0.091          | 0.111          |
| 应聘者2 | 0.119          | 0.098          | 0.130          | 0.116          |
| 应聘者3 | 0.097          | 0.124          | 0.108          | 0.107          |
| 应聘者4 | 0.119          | 0.109          | 0.117          | 0.104          |
| 应聘者5 | 0.102          | 0.122          | 0.112          | 0.122          |
| 应聘者6 | 0.104          | 0.121          | 0.121          | 0.101          |
| 应聘者7 | 0.119          | 0.114          | 0.126          | 0.095          |
| 应聘者8 | 0.123          | 0.097          | 0.098          | 0.126          |
| 应聘者9 | 0.119          | 0.093          | 0.097          | 0.118          |

#####  2.计算各指标的熵值

$$
e_{j}=-k \sum_{i=1}^{n} p_{i j} \ln p_{i j}, \quad(j=1,2, \cdots, m)
$$

其中 $k$与样本数量有关，常取$k=1/\ln_{}{n}$ ，此外，补充定义：若 $p_{ij}=0$ ，则令$p_{ij}\ln_{}{p_{ij}}=0$

举例数据熵值

| 类型     | 专业课1-去量纲 | 专业课2-去量纲 | 专业课3-去量纲 | 专业课4-去量纲 |
| -------- | -------------- | -------------- | -------------- | -------------- |
| 熵值 $e$ | 0.9981         | 0.9975         | 0.997          | 0.9982         |

##### 3.计算权重系数

$$
h_{j}=\frac{1-e_{j}}{\sum_{k=1}^{m}\left(1-e_{k}\right)}, \quad(j=1,2, \cdots, m)
$$

熵权系数$h_{j}$ 越大，则该指标代表的信息量越大，表示其对综合评价的作用越大。

举例数据权重系数

| 类型         | 专业课1-去量纲 | 专业课2-去量纲 | 专业课3-去量纲 | 专业课4-去量纲 |
| ------------ | -------------- | -------------- | -------------- | -------------- |
| 权重系数 $h$ | 20.71%         | 27.35%         | 32.89%         | 19.05%         |

##### 4.计算对象得分

$$
\left[\begin{array}{c}
\sum_{j=1}^{m}\left(x_{1 j} \times h_{j}\right) \\
\sum_{j=1}^{m}\left(x_{2 j} \times h_{j}\right) \\
\vdots \\
\sum_{j=1}^{m}\left(x_{n j} \times h_{j}\right)
\end{array}\right]
$$

| 编号    | 专业课1 | 专业课2 | 专业课3 | 专业课4 | 总分  |
| ------- | ------- | ------- | ------- | ------- | ----- |
| 应聘者1 | 67      | 90      | 67      | 81      | 75.96 |
| 应聘者2 | 82      | 73      | 95      | 85      | 84.39 |
| 应聘者3 | 67      | 92      | 79      | 78      | 79.88 |
| 应聘者4 | 82      | 81      | 86      | 76      | 81.90 |

#### 代码实践

```python
# 代码段
def get_entropy_weight(data):
    '''
    计算权重系数
    :param data: 二维数组 n行*m列 n个待评价对象 m个评价指标
    :return:指标权重 一维数组 m个值
    '''
    data = np.array(data)
    # 归一化
    P = data / data.sum(axis=0)
    # 计算熵值
    E = np.nansum(-P * np.log(P) / np.log(len(data)), axis=0)
    # 权重系数
    return list((1 - E) / (1 - E).sum())
```

详情代码: [EntropyModel.py](